# 星星点位绘制工具

一个基于Vue3 + Konva的星星点位绘制工具，支持用户上传背景图片、导入星星点位数据，在画布上绘制星星并连接，支持整体拖拽、缩放、旋转和导出功能。

## 项目概述

### 项目目标
开发一个基于Vue3 + Konva的星星点位绘制工具，支持用户上传背景图片、导入星星点位数据，在画布上绘制星星并连接，支持整体拖拽、缩放、旋转和导出功能。

### 技术栈
- Vue3 + Vite
- Element-Plus (UI组件库)
- TailwindCSS (样式框架)
- Konva (2D画布库)
- Pinia (状态管理)
- Vue Router (路由管理)

## 功能特性

### 核心功能
- ✅ 背景图片管理（上传本地图片、纯色背景、网格背景）
- ✅ 星星点位数据导入（JSON格式，支持相对坐标和绝对坐标）
- ✅ 星星绘制与连接（根据连接关系连接星星）
- ✅ 星星组操作功能（整体拖拽、缩放、旋转，实时更新连线）
- ✅ 导出功能（导出为PNG/JPG图片，支持多倍分辨率）

### 样式定制
- ✅ 星星样式设置（大小、颜色、描边、阴影）
- ✅ 连线样式设置（颜色、粗细、实线/虚线、阴影）
- ✅ 实时预览样式变化

### 画布设置
- ✅ 多种画布比例（9:16、3:4、1:1、自适应）
- ✅ 背景类型切换（网格、图片、纯色）
- ✅ 响应式布局

## 安装和运行

### 1. 安装依赖
```bash
npm install
```

### 2. 启动开发服务器
```bash
npm run dev
```

### 3. 构建生产版本
```bash
npm run build
```

### 4. 预览生产版本
```bash
npm run preview
```

## 使用说明

### 1. 设置画布
- 在左侧栏选择画布比例（9:16、3:4、1:1、自适应）
- 选择背景类型：
  - **网格**：默认白色背景 + 灰色网格
  - **图片**：上传本地图片作为背景
  - **纯色**：选择纯色背景

### 2. 导入星星点位数据
在左侧栏的文本框中输入JSON格式的星星点位数据：

#### 标准格式（推荐）
```json
{
  "points": [
    {"id": 1, "x": 0.21, "y": 0.25},
    {"id": 2, "x": 0.2838, "y": 0.2817},
    {"id": 3, "x": 0.1, "y": 0.4428}
  ],
  "connections": [[1, 2], [2, 3]]
}
```

#### 相对坐标格式（0-1范围）
```json
{
  "points": [
    {"id": 1, "x": 0.21, "y": 0.25},
    {"id": 2, "x": 0.2838, "y": 0.2817}
  ],
  "connections": [[1, 2]]
}
```

#### 绝对坐标格式（像素值）
```json
{
  "points": [
    {"id": 1, "x": 100, "y": 150},
    {"id": 2, "x": 200, "y": 180}
  ],
  "connections": [[1, 2]]
}
```

点击"生成星星"按钮创建星星和连线。

### 3. 调整样式
在右侧栏可以调整：

#### 星星样式
- 大小（半径：5-50）
- 填充颜色
- 描边颜色和宽度
- 阴影效果（颜色、模糊度、偏移）

#### 连线样式
- 线条颜色
- 线条粗细（1-10）
- 线条类型（实线/虚线）
- 阴影效果

### 4. 星星组操作
- **显示操作框**：点击星星或连线区域，会显示Transform选择框
- **拖拽**：直接拖拽星星组可以整体移动所有星星和连线
- **缩放**：拖拽Transform选择框的四个角锚点可以整体缩放
- **旋转**：拖拽Transform选择框的旋转锚点可以整体旋转
- **隐藏操作框**：点击空白区域可以隐藏Transform选择框
- 所有操作都会实时更新连线位置，操作结束后自动保存位置

### 5. 导出图片
点击右上角的"导出图片"按钮，可以选择：
- **导出格式**：PNG（透明背景）或 JPG（白色背景）
- **导出分辨率**：2倍、3倍、4倍分辨率（超高清）
- 导出后自动下载，文件名包含时间戳

## 项目结构

```
src/
├── components/
│   ├── CanvasComponent.vue    # 主画布组件
│   ├── LeftSidebar.vue        # 左侧栏组件
│   └── RightSidebar.vue       # 右侧栏组件
├── stores/
│   └── canvas.js              # Pinia状态管理
├── views/
│   └── Home.vue               # 主页面
├── router/
│   └── index.js               # 路由配置
├── App.vue                    # 根组件
├── main.js                    # 应用入口
└── style.css                  # 全局样式
```

## 数据格式说明

### 星星点位JSON格式
标准格式包含 `points` 和 `connections` 两个字段：

- **points**: 星星点位数组
  - `id`: 星星唯一标识（必需）
  - `x`: X坐标（相对坐标：0-1，绝对坐标：像素值）
  - `y`: Y坐标（相对坐标：0-1，绝对坐标：像素值）
  - `radius`: 星星大小（可选，会使用全局样式）
  - `fill`: 填充颜色（可选，会使用全局样式）

- **connections**: 连接关系数组
  - 格式：`[[id1, id2], [id2, id3], ...]`
  - 表示连接 id=id1 和 id=id2 的星星点

### 坐标系统
- 坐标原点：画布左上角 (0,0)
- 相对坐标：0-1范围，会根据画布尺寸自动转换为像素值
- 绝对坐标：像素值，直接使用
- 如果设置了背景图片，相对坐标会按图片比例计算

## 浏览器兼容性

- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

## 开发说明

### 主要依赖
- `vue`: Vue3框架
- `konva`: 2D画布库，用于绘制和交互
- `element-plus`: UI组件库
- `pinia`: 状态管理
- `tailwindcss`: CSS框架

### 核心实现
- 使用Konva.js实现画布绘制和交互
- Pinia管理应用状态
- Element-Plus提供UI组件
- TailwindCSS处理样式

## 许可证

MIT License
